{
  "hash": "8faa1ae277f038cb96802dd2e3484b27",
  "result": {
    "markdown": "---\ntitle: \"Concept of Tidy Data, Vectors & Pivoting\"\nsubtitle: \"CVEN 5837 - Summer 2023\"\nauthor: \"Lars Schöbitz\"\nformat: \n  revealjs: \n    theme: slides.scss\n    transition: fade\n    slide-number: true\n    logo: img/logo.png\n    footer: \"https://cven5873-ss23.github.io/website/\"\neditor: source\nexecute:\n  freeze: auto\nparams:\n    week: 5\n---\n\n\n\n<script defer data-domain=\"cven5837-ss23.github.io/website\" src=\"https://plausible.io/js/plausible.js\"></script>\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n\n```{.r .cell-code}\nlibrary(knitr)\n\nggplot2::theme_set(ggplot2::theme_gray(base_size = 16))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nwaste_data_lord1 <- read_csv(\n  here::here(\"slides/data/waste-characterisation-lord-of-the-bins-sheet1.csv\"))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 5 Columns: 12\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (2): location, day_of_collection\ndbl (10): objid, bin_id, bin_id_2, non_recyclables_ Kg, pet_Kg, metal_conten...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n```{.r .cell-code}\nwaste_data_lord2 <- read_csv(\n  here::here(\"slides/data/waste-characterisation-lord-of-the-bins-sheet2.csv\"))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 5 Columns: 12\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (2): location, day_of_collection\ndbl (10): objid, bin_id, bin_id_2, non_recyclables_ Kg, pet_Kg, metal_conten...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n```{.r .cell-code}\nsurvey_data <- read_csv(here::here(\"slides/data/survey-data-partners-in-grime.csv\")) |> \n  mutate(id = seq(1:n()))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 22 Columns: 15\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (14): date_started, age, job, residence_situation, residence_type, locat...\ndbl  (1): residence_distance\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n```{.r .cell-code}\nsurvey_data_small <- survey_data |> \n  select(id, job, price_glass)\n\nsurvey_data_tidy <- survey_data |> \n  select(id, job, residence_situation, starts_with(\"price\")) |> \n  pivot_longer(cols = starts_with(\"price\"),\n               names_to = \"waste_category\",\n               values_to = \"price\") |> \n  mutate(waste_category = str_remove(waste_category, pattern = \"price_\")) |> \n  mutate(price_new = case_when(\n    price == \"5 to 10\" ~ \"7.5\",\n    price == \"05-Oct\" ~ \"7.5\",\n    str_detect(price, pattern = \"20\") == TRUE ~ \"20\",\n    str_detect(price, pattern = \"See comment\") == TRUE ~ NA_character_,\n    TRUE ~ price\n  )) |> \n  mutate(price = as.numeric(price_new)) |> \n  select(-price_new)\n\nsurvey_data_tidy |> \n  count(job, residence_situation, waste_category, price) |> \n  ggplot(aes(x = factor(price), y = n, fill = job)) +\n  geom_col()\n```\n\n::: {.cell-output-display}\n![](lec-04-tidy-data_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nwaste_data <- bind_rows(waste_data_lord1, waste_data_lord2)\n\nwaste_data_untidy <- waste_data |> \n  filter(!is.na(objid)) |> \n  rename(non_recyclable_Kg = `non_recyclables_ Kg`,\n         recyclable_Kg = recyclables_Kg) |>\n  relocate(c(recyclable_Kg, non_recyclable_Kg), .before = weight_total_kg) |> \n  select(objid, location, pet_Kg:weight_total_kg) |> \n  mutate(objid = factor(objid)) |>\n  rename_with(~str_remove(.x, \"_Kg|_kg\")) |> \n  rename_with(~str_remove(.x, \"_content\")) |> \n  rename(total = weight_total)\n\n\nwaste_category_levels <- c(\"glass\", \"metal_alu\", \"paper\", \"pet\", \"other\")\n\nwaste_data_tidy <- waste_data_untidy |> \n  select(objid:paper, non_recyclable) |> \n  rename(other = non_recyclable) |> \n  mutate(objid = factor(objid)) |>\n  pivot_longer(cols = pet:other,\n               names_to = \"waste_category\",\n               values_to = \"weight\") |> \n  mutate(waste_category = factor(waste_category, levels = waste_category_levels)) |> \n  mutate(type = case_when(\n    waste_category == \"other\" ~ \"non_recyclable\",\n    TRUE ~ \"recyclable\")) |> \n  relocate(type, .before = weight) |> \n  group_by(objid) |> \n  mutate(percent = weight / sum(weight) * 100)\n\nwaste_data_tidy |> \n  write_rds(here::here(\"slides/data/intermediate_data/waste-characterisation-lord-of-the-bins-tidy.rds\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nwaste_data_tidy |> \n  group_by(location, waste_category) |> \n  summarise(weight = mean(weight)) |> \n  group_by(location) |> \n  mutate(percent = weight / sum(weight) * 100) \n\nwaste_data_tidy |> \n  \n  ggplot(mapping = aes(x = waste_category, y = weight, color = type)) +\n  geom_boxplot() +\n  geom_jitter(width = 0.2) +\n  facet_wrap(~location)\n\nwaste_data_tidy |> \n  ggplot(mapping = aes(x = objid, y = weight)) +\n  geom_col() \n\nwaste_data_tidy |> \n  ggplot(mapping = aes(x = objid, y = weight, fill = waste_category)) +\n  geom_col() \n\nwaste_data_tidy |> \n  ggplot(mapping = aes(x = waste_category, y = percent, color = type)) +\n  geom_boxplot() +\n  geom_jitter(width = 0.2) +\n  facet_wrap(~location)\n\n\nwaste_data_tidy |> \n  ggplot(aes(x = objid, y = percent, fill = waste_category)) +\n  geom_col() \n\nwaste_data_tidy |> \n  ggplot(aes(x = objid, y = percent, fill = type)) +\n  geom_col() \n\nwaste_data_tidy |> \n  ggplot(aes(x = objid, y = percent, fill = location)) +\n  geom_col() +\n  facet_wrap(~waste_category, ncol = 5)\n```\n:::\n\n\n\n## Learning Objectives (for this week)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlobj1 <- readr::read_csv(here::here(\"data/tbl-02-cven5837-ss23-learning-objectives.csv\")) |>\n  dplyr::filter(week == params$week) |>\n  dplyr::pull(learning_objectives)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 22 Columns: 4\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (2): title, learning_objectives\ndbl  (1): week\ndttm (1): date\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n:::\n\n\n\n1. Learners can apply functions from the dplyr R Package to transform their data from a wide to a long format and vice versa.\n2. Learners can list the four main atomic vector types in R.\n3. Learners can explain the three characteristics of tidy data.\n\n# Part 1: Data types and vectors {background-color=\"#0F4C81\"}\n\n## Why care about data types?\n\n<div style=\"width:75%;height:0;padding-bottom:83%;position:relative;\"><iframe src=\"https://giphy.com/embed/SvRuvlSEa67wNNHuHy\" width=\"75%\" height=\"75%\" style=\"position:absolute\" frameBorder=\"0\" class=\"giphy-embed\" allowFullScreen></iframe></div><p><a href=\"https://giphy.com/gifs/Friends-episode-20-friends-tv-the-one-with-baby-shower-SvRuvlSEa67wNNHuHy\">via GIPHY</a></p>\n\n## Example: survey data {.smaller .scrollable}\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n| id|job      |price_glass                                   |\n|--:|:--------|:---------------------------------------------|\n|  1|Student  |0                                             |\n|  2|Retired  |0                                             |\n|  3|Other    |0                                             |\n|  4|Employed |10                                            |\n|  5|Employed |See comment                                   |\n|  6|Student  |05-Oct                                        |\n|  7|Student  |0                                             |\n|  8|Retired  |0                                             |\n|  9|Student  |10                                            |\n| 10|Employed |0                                             |\n| 11|Employed |20 (2chf per person with 10 people in the WG) |\n| 12|Student  |10                                            |\n| 13|Student  |10                                            |\n| 14|Employed |0                                             |\n| 15|Student  |10                                            |\n| 16|Student  |0                                             |\n| 17|Employed |5 to 10                                       |\n| 18|Other    |0                                             |\n| 19|Student  |0                                             |\n| 20|Employed |10                                            |\n| 21|Employed |0                                             |\n| 22|Employed |5                                             |\n:::\n:::\n\n\n\n## Oh why won't you work?! {.smaller}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsurvey_data_small |> \n  summarise(mean_price_glass = mean(price_glass))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: There was 1 warning in `summarise()`.\nℹ In argument: `mean_price_glass = mean(price_glass)`.\nCaused by warning in `mean.default()`:\n! argument is not numeric or logical: returning NA\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 1\n  mean_price_glass\n             <dbl>\n1               NA\n```\n:::\n:::\n\n\n\n## Oh why won't you still work??!! {.smaller}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsurvey_data_small |> \n  summarise(mean_price_glass = mean(price_glass, na.rm = TRUE))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: There was 1 warning in `summarise()`.\nℹ In argument: `mean_price_glass = mean(price_glass, na.rm = TRUE)`.\nCaused by warning in `mean.default()`:\n! argument is not numeric or logical: returning NA\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 1\n  mean_price_glass\n             <dbl>\n1               NA\n```\n:::\n:::\n\n\n\n## Take a breath and look at your data {.smaller}\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n| id|job      |price_glass                                   |\n|--:|:--------|:---------------------------------------------|\n|  1|Student  |0                                             |\n|  2|Retired  |0                                             |\n|  3|Other    |0                                             |\n|  4|Employed |10                                            |\n|  5|Employed |See comment                                   |\n|  6|Student  |05-Oct                                        |\n|  7|Student  |0                                             |\n|  8|Retired  |0                                             |\n|  9|Student  |10                                            |\n| 10|Employed |0                                             |\n| 11|Employed |20 (2chf per person with 10 people in the WG) |\n| 12|Student  |10                                            |\n| 13|Student  |10                                            |\n| 14|Employed |0                                             |\n| 15|Student  |10                                            |\n| 16|Student  |0                                             |\n| 17|Employed |5 to 10                                       |\n| 18|Other    |0                                             |\n| 19|Student  |0                                             |\n| 20|Employed |10                                            |\n| 21|Employed |0                                             |\n| 22|Employed |5                                             |\n:::\n:::\n\n\n\n## Very common data tidying step! {.smaller}\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-line-numbers=\"|2|3,4|5,6|7\"}\nsurvey_data_small |> \n  mutate(price_glass_new = case_when(\n    price_glass == \"5 to 10\" ~ \"7.5\",\n    price_glass == \"05-Oct\" ~ \"7.5\",\n    str_detect(price_glass, pattern = \"20\") == TRUE ~ \"20\",\n    str_detect(price_glass, pattern = \"See comment\") == TRUE ~ NA_character_,\n    TRUE ~ price_glass\n  )) \n```\n:::\n\n\n\n## Very common data tidying step! {.scrollable .smaller}\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n| id|job      |price_glass_new |price_glass                                   |\n|--:|:--------|:---------------|:---------------------------------------------|\n|  1|Student  |0               |0                                             |\n|  2|Retired  |0               |0                                             |\n|  3|Other    |0               |0                                             |\n|  4|Employed |10              |10                                            |\n|  5|Employed |NA              |See comment                                   |\n|  6|Student  |7.5             |05-Oct                                        |\n|  7|Student  |0               |0                                             |\n|  8|Retired  |0               |0                                             |\n|  9|Student  |10              |10                                            |\n| 10|Employed |0               |0                                             |\n| 11|Employed |20              |20 (2chf per person with 10 people in the WG) |\n| 12|Student  |10              |10                                            |\n| 13|Student  |10              |10                                            |\n| 14|Employed |0               |0                                             |\n| 15|Student  |10              |10                                            |\n| 16|Student  |0               |0                                             |\n| 17|Employed |7.5             |5 to 10                                       |\n| 18|Other    |0               |0                                             |\n| 19|Student  |0               |0                                             |\n| 20|Employed |10              |10                                            |\n| 21|Employed |0               |0                                             |\n| 22|Employed |5               |5                                             |\n:::\n:::\n\n\n\n## Sumamrise? Argh!!!!  {auto-animate=\"true\" .smaller}\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-line-numbers=\"9\"}\nsurvey_data_small |> \n  mutate(price_glass_new = case_when(\n    price_glass == \"5 to 10\" ~ \"7.5\",\n    price_glass == \"05-Oct\" ~ \"7.5\",\n    str_detect(price_glass, pattern = \"20\") == TRUE ~ \"20\",\n    str_detect(price_glass, pattern = \"See comment\") == TRUE ~ NA_character_,\n    TRUE ~ price_glass\n  )) |> \n  summarise(mean_price_glass = mean(price_glass_new, na.rm = TRUE))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: There was 1 warning in `summarise()`.\nℹ In argument: `mean_price_glass = mean(price_glass_new, na.rm = TRUE)`.\nCaused by warning in `mean.default()`:\n! argument is not numeric or logical: returning NA\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 1\n  mean_price_glass\n             <dbl>\n1               NA\n```\n:::\n:::\n\n\n\n## Always respect your data types!  {auto-animate=\"true\" .smaller}\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-line-numbers=\"9|10\"}\nsurvey_data_small |> \n  mutate(price_glass_new = case_when(\n    price_glass == \"5 to 10\" ~ \"7.5\",\n    price_glass == \"05-Oct\" ~ \"7.5\",\n    str_detect(price_glass, pattern = \"20\") == TRUE ~ \"20\",\n    str_detect(price_glass, pattern = \"See comment\") == TRUE ~ NA_character_,\n    TRUE ~ price_glass\n  )) |> \n  mutate(price_glass_new = as.numeric(price_glass_new)) |> \n  summarise(mean_price_glass = mean(price_glass_new, na.rm = TRUE))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 1\n  mean_price_glass\n             <dbl>\n1             4.76\n```\n:::\n:::\n\n\n\n# Live Coding Exercise: Vectors {background-color=\"#0F4C81\"}\n\n## live-04a-vectors\n\n1. Head over to rstudio.cloud\n2. Open the workspace for the course (cven5837-ss22)\n3. Open \"Projects\"\n4. Open the \"course-materials\" project\n5. Follow along with me\n\n# Break One\n\n![](img/lec-01/coffee-break.jpg)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncountdown::countdown(\n  minutes = 10, seconds = 0,\n  left = 0, right = 0,\n  padding = \"10px\", margin = \"5%\",\n  font_size = \"2em\"\n)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"countdown\" id=\"timer_87fc344c\" data-update-every=\"1\" tabindex=\"0\" style=\"right:0;bottom:0;left:0;margin:5%;padding:10px;font-size:2em;\">\n<div class=\"countdown-controls\"><button class=\"countdown-bump-down\">&minus;</button><button class=\"countdown-bump-up\">&plus;</button></div>\n<code class=\"countdown-time\"><span class=\"countdown-digits minutes\">10</span><span class=\"countdown-digits colon\">:</span><span class=\"countdown-digits seconds\">00</span></code>\n</div>\n```\n:::\n:::\n\n\n\n::: aside\nPhoto by [Blake Wisz](https://unsplash.com/@blakewisz)\n:::\n\n# Part 2: tidyr - long and wide formats {background-color=\"#0F4C81\"}\n\n## . {background-image=\"img/lec-04/tidydata_1.jpg\" background-size=\"contain\"}\n\n\n::: aside\nIllustrations from the [Openscapes](https://www.openscapes.org/) blog [Tidy Data for reproducibility, efficiency, and collaboration](https://www.openscapes.org/blog/2020/10/12/tidy-data/) by [Julia Lowndes](https://twitter.com/juliesquid) and [Allison Horst](https://twitter.com/allison_horst)\n:::\n\n## . {background-image=\"img/lec-04/tidydata_2.jpg\" background-size=\"contain\"}\n\n::: aside\nIllustrations from the [Openscapes](https://www.openscapes.org/) blog [Tidy Data for reproducibility, efficiency, and collaboration](https://www.openscapes.org/blog/2020/10/12/tidy-data/) by [Julia Lowndes](https://twitter.com/juliesquid) and [Allison Horst](https://twitter.com/allison_horst)\n:::\n\n## . {background-image=\"img/lec-04/tidydata_3.jpg\" background-size=\"contain\"}\n\n::: aside\nIllustrations from the [Openscapes](https://www.openscapes.org/) blog [Tidy Data for reproducibility, efficiency, and collaboration](https://www.openscapes.org/blog/2020/10/12/tidy-data/) by [Julia Lowndes](https://twitter.com/juliesquid) and [Allison Horst](https://twitter.com/allison_horst)\n:::\n\n## A grammar of data tidying {.smaller}\n\n:::: {.columns}\n\n::: {.column width=\"40%\"}\n\n\n\n::: {.cell caption='tidyr is part of the tidyverse'}\n::: {.cell-output-display}\n![](img/lec-04/tidyr-part-of-tidyverse.png){width=60%}\n:::\n:::\n\n\n\n:::\n\n::: {.column width=\"60%\"}\n\nThe goal of tidyr is to help you tidy your data via\n\n- pivoting for going between wide and long data\n- splitting and combining character columns\n- nesting and unnesting columns\n- clarifying how `NA`s should be treated\n:::\n\n::::\n\n::: aside\nSlide taken from [Data Science in a Box](https://datasciencebox.org/)\n:::\n\n## Pivoting data\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](img/lec-04/tidyr-longer-wider.gif){width=45% style=\"background-color: #FDF6E3\"}\n:::\n:::\n\n\n\n## Waste characterisation data {.smaller}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwaste_data_untidy |> \n  knitr::kable(digits = 2)\n```\n\n::: {.cell-output-display}\n|objid |location |  pet| metal_alu| glass| paper| recyclable| non_recyclable| total|\n|:-----|:--------|----:|---------:|-----:|-----:|----------:|--------------:|-----:|\n|900   |eth      | 0.06|      0.06|  0.58|  0.21|       0.92|           1.14|  2.05|\n|899   |eth      | 0.14|      0.01|  0.18|  0.28|       0.61|           3.04|  3.64|\n|921   |old_town | 0.00|      0.00|  0.00|  0.41|       0.41|           1.57|  1.99|\n|916   |old_town | 0.17|      0.04|  0.80|  0.55|       1.56|           0.62|  2.19|\n|900   |eth      | 0.10|      0.04|  0.00|  0.40|       0.54|           0.58|  1.12|\n|899   |eth      | 0.08|      0.03|  0.00|  0.05|       0.16|           0.34|  0.50|\n|921   |old_town | 0.08|      0.03|  0.30|  0.40|       0.81|           1.52|  2.33|\n|916   |old_town | 0.11|      0.04|  0.92|  1.01|       2.08|           1.99|  4.07|\n:::\n:::\n\n\n\n\n## How would you plot this?\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = waste_data_untidy,\n       mapping = aes(x = objid, y = total, fill = location)) +\n  geom_col() \n```\n\n::: {.cell-output-display}\n![](lec-04-tidy-data_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\n\n## And this?\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = waste_data_tidy,\n       mapping = aes(x = objid, y = weight, fill = waste_category)) +\n  geom_col() \n```\n\n::: {.cell-output-display}\n![](lec-04-tidy-data_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n\n\n## You need: A long format {.smaller .scrollable}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwaste_data_tidy |> \n  select(-percent, -type) |> \n  knitr::kable(digits = 2)\n```\n\n::: {.cell-output-display}\n|objid |location |waste_category | weight|\n|:-----|:--------|:--------------|------:|\n|900   |eth      |pet            |   0.06|\n|900   |eth      |metal_alu      |   0.06|\n|900   |eth      |glass          |   0.58|\n|900   |eth      |paper          |   0.21|\n|900   |eth      |other          |   1.14|\n|899   |eth      |pet            |   0.14|\n|899   |eth      |metal_alu      |   0.01|\n|899   |eth      |glass          |   0.18|\n|899   |eth      |paper          |   0.28|\n|899   |eth      |other          |   3.04|\n|921   |old_town |pet            |   0.00|\n|921   |old_town |metal_alu      |   0.00|\n|921   |old_town |glass          |   0.00|\n|921   |old_town |paper          |   0.41|\n|921   |old_town |other          |   1.57|\n|916   |old_town |pet            |   0.17|\n|916   |old_town |metal_alu      |   0.04|\n|916   |old_town |glass          |   0.80|\n|916   |old_town |paper          |   0.55|\n|916   |old_town |other          |   0.62|\n|900   |eth      |pet            |   0.10|\n|900   |eth      |metal_alu      |   0.04|\n|900   |eth      |glass          |   0.00|\n|900   |eth      |paper          |   0.40|\n|900   |eth      |other          |   0.58|\n|899   |eth      |pet            |   0.08|\n|899   |eth      |metal_alu      |   0.03|\n|899   |eth      |glass          |   0.00|\n|899   |eth      |paper          |   0.05|\n|899   |eth      |other          |   0.34|\n|921   |old_town |pet            |   0.08|\n|921   |old_town |metal_alu      |   0.03|\n|921   |old_town |glass          |   0.30|\n|921   |old_town |paper          |   0.40|\n|921   |old_town |other          |   1.52|\n|916   |old_town |pet            |   0.11|\n|916   |old_town |metal_alu      |   0.04|\n|916   |old_town |glass          |   0.92|\n|916   |old_town |paper          |   1.01|\n|916   |old_town |other          |   1.99|\n:::\n:::\n\n\n\n## Reminder: The wide format {.smaller .scrollable}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwaste_data_untidy |> \n  knitr::kable(digits = 2)\n```\n\n::: {.cell-output-display}\n|objid |location |  pet| metal_alu| glass| paper| recyclable| non_recyclable| total|\n|:-----|:--------|----:|---------:|-----:|-----:|----------:|--------------:|-----:|\n|900   |eth      | 0.06|      0.06|  0.58|  0.21|       0.92|           1.14|  2.05|\n|899   |eth      | 0.14|      0.01|  0.18|  0.28|       0.61|           3.04|  3.64|\n|921   |old_town | 0.00|      0.00|  0.00|  0.41|       0.41|           1.57|  1.99|\n|916   |old_town | 0.17|      0.04|  0.80|  0.55|       1.56|           0.62|  2.19|\n|900   |eth      | 0.10|      0.04|  0.00|  0.40|       0.54|           0.58|  1.12|\n|899   |eth      | 0.08|      0.03|  0.00|  0.05|       0.16|           0.34|  0.50|\n|921   |old_town | 0.08|      0.03|  0.30|  0.40|       0.81|           1.52|  2.33|\n|916   |old_town | 0.11|      0.04|  0.92|  1.01|       2.08|           1.99|  4.07|\n:::\n:::\n\n\n\n## Or this?\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwaste_data_tidy |> \n  ggplot(aes(x = objid, y = percent, fill = type)) +\n  geom_col() \n```\n\n::: {.cell-output-display}\n![](lec-04-tidy-data_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n\n\n## Calculate percentages {.smaller .scrollable}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwaste_data_tidy |> \n  knitr::kable(digits = 2)\n```\n\n::: {.cell-output-display}\n|objid |location |waste_category |type           | weight| percent|\n|:-----|:--------|:--------------|:--------------|------:|-------:|\n|900   |eth      |pet            |recyclable     |   0.06|    2.02|\n|900   |eth      |metal_alu      |recyclable     |   0.06|    1.95|\n|900   |eth      |glass          |recyclable     |   0.58|   18.14|\n|900   |eth      |paper          |recyclable     |   0.21|    6.74|\n|900   |eth      |other          |non_recyclable |   1.14|   35.78|\n|899   |eth      |pet            |recyclable     |   0.14|    3.33|\n|899   |eth      |metal_alu      |recyclable     |   0.01|    0.31|\n|899   |eth      |glass          |recyclable     |   0.18|    4.30|\n|899   |eth      |paper          |recyclable     |   0.28|    6.69|\n|899   |eth      |other          |non_recyclable |   3.04|   73.36|\n|921   |old_town |pet            |recyclable     |   0.00|    0.00|\n|921   |old_town |metal_alu      |recyclable     |   0.00|    0.00|\n|921   |old_town |glass          |recyclable     |   0.00|    0.00|\n|921   |old_town |paper          |recyclable     |   0.41|    9.60|\n|921   |old_town |other          |non_recyclable |   1.57|   36.46|\n|916   |old_town |pet            |recyclable     |   0.17|    2.76|\n|916   |old_town |metal_alu      |recyclable     |   0.04|    0.69|\n|916   |old_town |glass          |recyclable     |   0.80|   12.73|\n|916   |old_town |paper          |recyclable     |   0.55|    8.82|\n|916   |old_town |other          |non_recyclable |   0.62|    9.99|\n|900   |eth      |pet            |recyclable     |   0.10|    3.09|\n|900   |eth      |metal_alu      |recyclable     |   0.04|    1.35|\n|900   |eth      |glass          |recyclable     |   0.00|    0.00|\n|900   |eth      |paper          |recyclable     |   0.40|   12.60|\n|900   |eth      |other          |non_recyclable |   0.58|   18.33|\n|899   |eth      |pet            |recyclable     |   0.08|    1.86|\n|899   |eth      |metal_alu      |recyclable     |   0.03|    0.72|\n|899   |eth      |glass          |recyclable     |   0.00|    0.00|\n|899   |eth      |paper          |recyclable     |   0.05|    1.26|\n|899   |eth      |other          |non_recyclable |   0.34|    8.16|\n|921   |old_town |pet            |recyclable     |   0.08|    1.81|\n|921   |old_town |metal_alu      |recyclable     |   0.03|    0.70|\n|921   |old_town |glass          |recyclable     |   0.30|    6.89|\n|921   |old_town |paper          |recyclable     |   0.40|    9.32|\n|921   |old_town |other          |non_recyclable |   1.52|   35.21|\n|916   |old_town |pet            |recyclable     |   0.11|    1.74|\n|916   |old_town |metal_alu      |recyclable     |   0.04|    0.70|\n|916   |old_town |glass          |recyclable     |   0.92|   14.63|\n|916   |old_town |paper          |recyclable     |   1.01|   16.20|\n|916   |old_town |other          |non_recyclable |   1.99|   31.73|\n:::\n:::\n\n\n\n## How to {auto-animate=\"true\" .smaller .scrollable}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwaste_data_untidy \n```\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n|objid |location |  pet| metal_alu| glass| paper| recyclable| non_recyclable| total|\n|:-----|:--------|----:|---------:|-----:|-----:|----------:|--------------:|-----:|\n|900   |eth      | 0.06|      0.06|  0.58|  0.21|       0.92|           1.14|  2.05|\n|899   |eth      | 0.14|      0.01|  0.18|  0.28|       0.61|           3.04|  3.64|\n|921   |old_town | 0.00|      0.00|  0.00|  0.41|       0.41|           1.57|  1.99|\n|916   |old_town | 0.17|      0.04|  0.80|  0.55|       1.56|           0.62|  2.19|\n|900   |eth      | 0.10|      0.04|  0.00|  0.40|       0.54|           0.58|  1.12|\n|899   |eth      | 0.08|      0.03|  0.00|  0.05|       0.16|           0.34|  0.50|\n|921   |old_town | 0.08|      0.03|  0.30|  0.40|       0.81|           1.52|  2.33|\n|916   |old_town | 0.11|      0.04|  0.92|  1.01|       2.08|           1.99|  4.07|\n:::\n:::\n\n\n\n## How to {auto-animate=\"true\" .smaller .scrollable}\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-line-numbers=\"2\"}\nwaste_data_untidy |> \n  select(objid:paper, non_recyclable) \n```\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n|objid |location |  pet| metal_alu| glass| paper| non_recyclable|\n|:-----|:--------|----:|---------:|-----:|-----:|--------------:|\n|900   |eth      | 0.06|      0.06|  0.58|  0.21|           1.14|\n|899   |eth      | 0.14|      0.01|  0.18|  0.28|           3.04|\n|921   |old_town | 0.00|      0.00|  0.00|  0.41|           1.57|\n|916   |old_town | 0.17|      0.04|  0.80|  0.55|           0.62|\n|900   |eth      | 0.10|      0.04|  0.00|  0.40|           0.58|\n|899   |eth      | 0.08|      0.03|  0.00|  0.05|           0.34|\n|921   |old_town | 0.08|      0.03|  0.30|  0.40|           1.52|\n|916   |old_town | 0.11|      0.04|  0.92|  1.01|           1.99|\n:::\n:::\n\n\n\n## How to {auto-animate=\"true\" .smaller .scrollable}\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-line-numbers=\"3\"}\nwaste_data_untidy |> \n  select(objid:paper, non_recyclable) |> \n  rename(other = non_recyclable) \n```\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n|objid |location |  pet| metal_alu| glass| paper| other|\n|:-----|:--------|----:|---------:|-----:|-----:|-----:|\n|900   |eth      | 0.06|      0.06|  0.58|  0.21|  1.14|\n|899   |eth      | 0.14|      0.01|  0.18|  0.28|  3.04|\n|921   |old_town | 0.00|      0.00|  0.00|  0.41|  1.57|\n|916   |old_town | 0.17|      0.04|  0.80|  0.55|  0.62|\n|900   |eth      | 0.10|      0.04|  0.00|  0.40|  0.58|\n|899   |eth      | 0.08|      0.03|  0.00|  0.05|  0.34|\n|921   |old_town | 0.08|      0.03|  0.30|  0.40|  1.52|\n|916   |old_town | 0.11|      0.04|  0.92|  1.01|  1.99|\n:::\n:::\n\n\n\n## How to {auto-animate=\"true\" .smaller .scrollable}\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-line-numbers=\"1|6-8|9-10\"}\nwaste_category_levels <- c(\"glass\", \"metal_alu\", \"paper\", \"pet\", \"other\")\n\nwaste_data_untidy |> \n  select(objid:paper, non_recyclable) |> \n  rename(other = non_recyclable) |> \n  pivot_longer(cols = pet:other,\n               names_to = \"waste_category\",\n               values_to = \"weight\") |> \n  mutate(waste_category = factor(waste_category, \n                                 levels = waste_category_levels)) \n```\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n|objid |location |waste_category | weight|\n|:-----|:--------|:--------------|------:|\n|900   |eth      |pet            |   0.06|\n|900   |eth      |metal_alu      |   0.06|\n|900   |eth      |glass          |   0.58|\n|900   |eth      |paper          |   0.21|\n|900   |eth      |other          |   1.14|\n|899   |eth      |pet            |   0.14|\n|899   |eth      |metal_alu      |   0.01|\n|899   |eth      |glass          |   0.18|\n|899   |eth      |paper          |   0.28|\n|899   |eth      |other          |   3.04|\n|921   |old_town |pet            |   0.00|\n|921   |old_town |metal_alu      |   0.00|\n|921   |old_town |glass          |   0.00|\n|921   |old_town |paper          |   0.41|\n|921   |old_town |other          |   1.57|\n|916   |old_town |pet            |   0.17|\n|916   |old_town |metal_alu      |   0.04|\n|916   |old_town |glass          |   0.80|\n|916   |old_town |paper          |   0.55|\n|916   |old_town |other          |   0.62|\n|900   |eth      |pet            |   0.10|\n|900   |eth      |metal_alu      |   0.04|\n|900   |eth      |glass          |   0.00|\n|900   |eth      |paper          |   0.40|\n|900   |eth      |other          |   0.58|\n|899   |eth      |pet            |   0.08|\n|899   |eth      |metal_alu      |   0.03|\n|899   |eth      |glass          |   0.00|\n|899   |eth      |paper          |   0.05|\n|899   |eth      |other          |   0.34|\n|921   |old_town |pet            |   0.08|\n|921   |old_town |metal_alu      |   0.03|\n|921   |old_town |glass          |   0.30|\n|921   |old_town |paper          |   0.40|\n|921   |old_town |other          |   1.52|\n|916   |old_town |pet            |   0.11|\n|916   |old_town |metal_alu      |   0.04|\n|916   |old_town |glass          |   0.92|\n|916   |old_town |paper          |   1.01|\n|916   |old_town |other          |   1.99|\n:::\n:::\n\n\n\n## How to {auto-animate=\"true\" .smaller .scrollable}\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-line-numbers=\"11-13|14\"}\nwaste_category_levels <- c(\"glass\", \"metal_alu\", \"paper\", \"pet\", \"other\")\n\nwaste_data_untidy |> \n  select(objid:paper, non_recyclable) |> \n  rename(other = non_recyclable) |> \n  pivot_longer(cols = pet:other,\n               names_to = \"waste_category\",\n               values_to = \"weight\") |> \n  mutate(waste_category = factor(waste_category, \n                                 levels = waste_category_levels)) |>\n  mutate(type = case_when(\n    waste_category == \"other\" ~ \"non_recyclable\",\n    TRUE ~ \"recyclable\")) |> \n  relocate(type, .before = weight)\n```\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n|objid |location |waste_category |type           | weight|\n|:-----|:--------|:--------------|:--------------|------:|\n|900   |eth      |pet            |recyclable     |   0.06|\n|900   |eth      |metal_alu      |recyclable     |   0.06|\n|900   |eth      |glass          |recyclable     |   0.58|\n|900   |eth      |paper          |recyclable     |   0.21|\n|900   |eth      |other          |non_recyclable |   1.14|\n|899   |eth      |pet            |recyclable     |   0.14|\n|899   |eth      |metal_alu      |recyclable     |   0.01|\n|899   |eth      |glass          |recyclable     |   0.18|\n|899   |eth      |paper          |recyclable     |   0.28|\n|899   |eth      |other          |non_recyclable |   3.04|\n|921   |old_town |pet            |recyclable     |   0.00|\n|921   |old_town |metal_alu      |recyclable     |   0.00|\n|921   |old_town |glass          |recyclable     |   0.00|\n|921   |old_town |paper          |recyclable     |   0.41|\n|921   |old_town |other          |non_recyclable |   1.57|\n|916   |old_town |pet            |recyclable     |   0.17|\n|916   |old_town |metal_alu      |recyclable     |   0.04|\n|916   |old_town |glass          |recyclable     |   0.80|\n|916   |old_town |paper          |recyclable     |   0.55|\n|916   |old_town |other          |non_recyclable |   0.62|\n|900   |eth      |pet            |recyclable     |   0.10|\n|900   |eth      |metal_alu      |recyclable     |   0.04|\n|900   |eth      |glass          |recyclable     |   0.00|\n|900   |eth      |paper          |recyclable     |   0.40|\n|900   |eth      |other          |non_recyclable |   0.58|\n|899   |eth      |pet            |recyclable     |   0.08|\n|899   |eth      |metal_alu      |recyclable     |   0.03|\n|899   |eth      |glass          |recyclable     |   0.00|\n|899   |eth      |paper          |recyclable     |   0.05|\n|899   |eth      |other          |non_recyclable |   0.34|\n|921   |old_town |pet            |recyclable     |   0.08|\n|921   |old_town |metal_alu      |recyclable     |   0.03|\n|921   |old_town |glass          |recyclable     |   0.30|\n|921   |old_town |paper          |recyclable     |   0.40|\n|921   |old_town |other          |non_recyclable |   1.52|\n|916   |old_town |pet            |recyclable     |   0.11|\n|916   |old_town |metal_alu      |recyclable     |   0.04|\n|916   |old_town |glass          |recyclable     |   0.92|\n|916   |old_town |paper          |recyclable     |   1.01|\n|916   |old_town |other          |non_recyclable |   1.99|\n:::\n:::\n\n\n\n## How to {auto-animate=\"true\" .smaller .scrollable}\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-line-numbers=\"15-16\"}\nwaste_category_levels <- c(\"glass\", \"metal_alu\", \"paper\", \"pet\", \"other\")\n\nwaste_data_untidy |> \n  select(objid:paper, non_recyclable) |> \n  rename(other = non_recyclable) |> \n  pivot_longer(cols = pet:other,\n               names_to = \"waste_category\",\n               values_to = \"weight\") |> \n  mutate(waste_category = factor(waste_category, \n                                 levels = waste_category_levels)) |> \n  mutate(type = case_when(\n    waste_category == \"other\" ~ \"non_recyclable\",\n    TRUE ~ \"recyclable\")) |> \n  relocate(type, .before = weight) |> \n  group_by(objid) |> \n  mutate(percent = weight / sum(weight) * 100)\n```\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n|objid |location |waste_category |type           | weight| percent|\n|:-----|:--------|:--------------|:--------------|------:|-------:|\n|900   |eth      |pet            |recyclable     |   0.06|    2.02|\n|900   |eth      |metal_alu      |recyclable     |   0.06|    1.95|\n|900   |eth      |glass          |recyclable     |   0.58|   18.14|\n|900   |eth      |paper          |recyclable     |   0.21|    6.74|\n|900   |eth      |other          |non_recyclable |   1.14|   35.78|\n|899   |eth      |pet            |recyclable     |   0.14|    3.33|\n|899   |eth      |metal_alu      |recyclable     |   0.01|    0.31|\n|899   |eth      |glass          |recyclable     |   0.18|    4.30|\n|899   |eth      |paper          |recyclable     |   0.28|    6.69|\n|899   |eth      |other          |non_recyclable |   3.04|   73.36|\n|921   |old_town |pet            |recyclable     |   0.00|    0.00|\n|921   |old_town |metal_alu      |recyclable     |   0.00|    0.00|\n|921   |old_town |glass          |recyclable     |   0.00|    0.00|\n|921   |old_town |paper          |recyclable     |   0.41|    9.60|\n|921   |old_town |other          |non_recyclable |   1.57|   36.46|\n|916   |old_town |pet            |recyclable     |   0.17|    2.76|\n|916   |old_town |metal_alu      |recyclable     |   0.04|    0.69|\n|916   |old_town |glass          |recyclable     |   0.80|   12.73|\n|916   |old_town |paper          |recyclable     |   0.55|    8.82|\n|916   |old_town |other          |non_recyclable |   0.62|    9.99|\n|900   |eth      |pet            |recyclable     |   0.10|    3.09|\n|900   |eth      |metal_alu      |recyclable     |   0.04|    1.35|\n|900   |eth      |glass          |recyclable     |   0.00|    0.00|\n|900   |eth      |paper          |recyclable     |   0.40|   12.60|\n|900   |eth      |other          |non_recyclable |   0.58|   18.33|\n|899   |eth      |pet            |recyclable     |   0.08|    1.86|\n|899   |eth      |metal_alu      |recyclable     |   0.03|    0.72|\n|899   |eth      |glass          |recyclable     |   0.00|    0.00|\n|899   |eth      |paper          |recyclable     |   0.05|    1.26|\n|899   |eth      |other          |non_recyclable |   0.34|    8.16|\n|921   |old_town |pet            |recyclable     |   0.08|    1.81|\n|921   |old_town |metal_alu      |recyclable     |   0.03|    0.70|\n|921   |old_town |glass          |recyclable     |   0.30|    6.89|\n|921   |old_town |paper          |recyclable     |   0.40|    9.32|\n|921   |old_town |other          |non_recyclable |   1.52|   35.21|\n|916   |old_town |pet            |recyclable     |   0.11|    1.74|\n|916   |old_town |metal_alu      |recyclable     |   0.04|    0.70|\n|916   |old_town |glass          |recyclable     |   0.92|   14.63|\n|916   |old_town |paper          |recyclable     |   1.01|   16.20|\n|916   |old_town |other          |non_recyclable |   1.99|   31.73|\n:::\n:::\n\n\n\n# Live Coding Exercise: Pivoting {background-color=\"#0F4C81\"}\n\n## live-04a-tidyr-pivoting\n\n1. Head over to rstudio.cloud\n2. Open the workspace for the course (cven5837-ss22)\n3. Open \"Projects\"\n4. Open the \"course-materials\" project\n5. Follow along with me\n\n# Homework week 4 {background-color=\"#0F4C81\"}\n\n## Homework due dates\n\n- All material on [course website](https://cven5837-ss22.github.io/website/weeks/wk-04.html)\n- Homework assignment due: Friday, 29th July\n- Learning reflection due: Monday, 1st August\n\n# Thanks! 🌻  {background-color=\"#0F4C81\"}\n\n## \n\nSlides created via revealjs and Quarto: https://quarto.org/docs/presentations/revealjs/ \nAccess slides as [PDF on GitHub](https://github.com/cven5873-ss23/website/raw/main/slides/lec-04-tidy-data.pdf)\n\nAll material is licensed under [Creative Commons Attribution Share Alike 4.0 International](https://creativecommons.org/licenses/by-sa/4.0/). \n\n\n",
    "supporting": [
      "lec-04-tidy-data_files/figure-html"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../site_libs/countdown-0.4.0/countdown.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/countdown-0.4.0/countdown.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}